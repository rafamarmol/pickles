Sub DataSeperator()
'
' Macro1 Macro
'
' Keyboard Shortcut: Ctrl+Shift+Z
'





Dim BusData() As Variant
Dim FTI() As Variant
Dim ASix() As Variant
Dim j As Integer
Dim wksnm As String
Dim b As Integer
Dim n As Integer
Dim m As Integer
 
b = 0
n = 0
m = 0
 
WS_count = ActiveWorkbook.Worksheets.Count
For j = 1 To WS_count
Worksheets(j).Select
wksnm = Worksheets(j).Name
 
    ReDim Nme(Len(wksnm) - 1)
    For I = 1 To Len(wksnm)
    Nme(I - 1) = Mid(wksnm, I, 1)
    Next I
If Nme(0) = "X" And Nme(1) = "A" Then
k = k + 1
ReDim Preserve BusData(k - 1) As Variant
    BusData(k - 1) = wksnm
ElseIf Nme(0) = "X" Then
n = n + 1
    ReDim Preserve FTI(n - 1) As Variant
    FTI(n - 1) = wksnm
ElseIf Nme(0) = "A" Then
m = m + 1
    ReDim Preserve ASix(m - 1) As Variant
    ASix(m - 1) = wksnm
End If
Next j
 
If k = 0 Then
BusData = Array("")
End If

If n = 0 Then
FTI = Array("")
End If

If m = 0 Then
ASix = Array("")
End If



    Dim sheet As Variant
    Dim arrCounter As Integer
    Dim names(0 To 2) As String
    
    
    
    names(0) = "BusData"
    names(1) = "FTI"
    names(2) = "ASix"
    
    arrCounter = 0


    sheet = Array(BusData, FTI, ASix)
    
    WS_count = ActiveWorkbook.Worksheets.Count
    paths = Application.ActiveWorkbook.Path + "\"
    current = Application.ActiveWorkbook.Name
    'Creating new sheet named 'data'
    Sheets.Add(After:=Sheets(WS_count)).Name = "data"
    'Dim I As Integer
    For Each arr In sheet
        For I = 1 To WS_count
            Worksheets(I).Select
            If IsInArray(Worksheets(I).Name, arr) Then
                'grab values from a sheet
                Worksheets(I).Range("B1").Select
                Worksheets(I).Range(Selection, Selection.End(xlToRight)).Select
                Worksheets(I).Range(Selection, Selection.End(xlDown)).Select
                Selection.Cut
                'paste values into 'data' sheet
                Sheets("data").Select
                Worksheets("data").Range("B1").Select
                If Selection.Value = Empty Then 'fist time case
                    Worksheets("data").Paste
                    'adding times
                    Sheets(I).Select
                    Worksheets(I).Range("A4").Select
                    Worksheets(I).Range(Selection, Selection.End(xlDown)).Select
                    Selection.Cut
                    Sheets("data").Select
                    Worksheets("data").Range("A4").Select
                    Worksheets("data").Paste
                    Worksheets("data").Range("A1").ColumnWidth = 25
                Else
                    Selection.End(xlToRight).Offset(0, 1).Select
                    Worksheets("data").Paste
                End If
            End If
        Next I
        'add new depending on the type of data
        Workbooks.Add
        ActiveWorkbook.SaveAs Filename:=paths & names(arrCounter) & ".xlsx", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False
        Set wbk = Workbooks.Open(Filename:=paths & names(arrCounter) & ".xlsx")
        'copying
        Workbooks(current).Activate
        Worksheets("data").Activate
        ActiveSheet.Range("A1").Select
        ActiveSheet.Range(Selection, Selection.End(xlToRight).End(xlToRight).End(xlDown)).Select
        Selection.Cut
        'pasting
        Windows(names(arrCounter) & ".xlsx").Activate
        ActiveSheet.Range("A1").Select
        ActiveSheet.Paste
        ActiveSheet.Range("A1").ColumnWidth = 25
        wbk.Close savechanges:=True
        arrCounter = arrCounter + 1
    Next arr
End Sub

Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean
    IsInArray = (UBound(Filter(arr, stringToBeFound)) > -1)
End Function
